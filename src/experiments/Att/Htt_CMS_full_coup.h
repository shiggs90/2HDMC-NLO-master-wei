double Htt_CMS_full_coup(double x, double y)
{
y=y*100;
double limit = 100000;
if (y<=0.5)
{   
      if ((400<=x)&&(x<=425.33)) {
            limit =0.844029+(x-400)*(0.715635-0.844029)/(425.33-400);
      }
      if ((425.33<=x)&&(x<=449.472)) {
            limit =0.715635+(x-425.33)*(0.696021-0.715635)/(449.472-425.33);
      }
      if ((449.472<=x)&&(x<=474.802)) {
            limit =0.696021+(x-449.472)*(0.65626-0.696021)/(474.802-449.472);
      }
      if ((474.802<=x)&&(x<=499.934)) {
            limit =0.65626+(x-474.802)*(0.65506-0.65626)/(499.934-474.802);
      }
      if ((499.934<=x)&&(x<=524.868)) {
            limit =0.65506+(x-499.934)*(0.705085-0.65506)/(524.868-499.934);
      }
      if ((524.868<=x)&&(x<=550.396)) {
            limit =0.705085+(x-524.868)*(0.715395-0.705085)/(550.396-524.868);
      }
      if ((550.396<=x)&&(x<=574.934)) {
            limit =0.715395+(x-550.396)*(0.704989-0.715395)/(574.934-550.396);
      }
      if ((574.934<=x)&&(x<=600.066)) {
            limit =0.704989+(x-574.934)*(0.634724-0.704989)/(600.066-574.934);
      }
      if ((600.066<=x)&&(x<=624.802)) {
            limit =0.634724+(x-600.066)*(0.613382-0.634724)/(624.802-600.066);
      }
      if ((624.802<=x)&&(x<=649.934)) {
            limit =0.613382+(x-624.802)*(0.625996-0.613382)/(649.934-624.802);
      }
      if ((649.934<=x)&&(x<=725.33)) {
            limit =0.625996+(x-649.934)*(0.87506-0.625996)/(725.33-649.934);
      }
      if ((725.33<=x)&&(x<=750)) {
            limit =0.87506+(x-725.33)*(0.933718-0.87506)/(750-725.33);
      }
}
if ((0.5<y) && (y<=1))
{
      if ((400<=x)&&(x<=425.156)) {
            limit =1.05288+(x-400)*(0.886567-1.05288)/(425.156-400);
      }
      if ((425.156<=x)&&(x<=449.603)) {
            limit =0.886567+(x-425.156)*(0.855864-0.886567)/(449.603-425.156);
      }
      if ((449.603<=x)&&(x<=475.221)) {
            limit =0.855864+(x-449.603)*(0.796162-0.855864)/(475.221-449.603);
      }
      if ((475.221<=x)&&(x<=499.681)) {
            limit =0.796162+(x-475.221)*(0.78678-0.796162)/(499.681-475.221);
      }
      if ((499.681<=x)&&(x<=525.132)) {
            limit =0.78678+(x-499.681)*(0.846482-0.78678)/(525.132-499.681);
      }
      if ((525.132<=x)&&(x<=575.262)) {
            limit =0.846482+(x-525.132)*(0.865245-0.846482)/(575.262-525.132);
      }
      if ((575.262<=x)&&(x<=599.906)) {
            limit =0.865245+(x-575.262)*(0.765458-0.865245)/(599.906-575.262);
      }
      if ((599.906<=x)&&(x<=625.067)) {
            limit =0.765458+(x-599.906)*(0.736461-0.765458)/(625.067-599.906);
      }
      if ((625.067<=x)&&(x<=650.246)) {
            limit =0.736461+(x-625.067)*(0.738166-0.736461)/(650.246-625.067);
      }
      if ((650.246<=x)&&(x<=675.239)) {
            limit =0.738166+(x-650.246)*(0.826013-0.738166)/(675.239-650.246);
      }
      if ((675.239<=x)&&(x<=724.776)) {
            limit =0.826013+(x-675.239)*(1.04606-0.826013)/(724.776-675.239);
      }
      if ((724.776<=x)&&(x<=750)) {
            limit =1.04606+(x-724.776)*(1.11514-1.04606)/(750-724.776);
      }
}
if ((1<y) && (y<=2.5))
{
      if ((400<=x)&&(x<=425.234)) {
            limit =1.37266+(x-400)*(1.15475-1.37266)/(425.234-400);
      }
      if ((425.234<=x)&&(x<=450.302)) {
            limit =1.15475+(x-425.234)*(1.08607-1.15475)/(450.302-425.234);
      }
      if ((450.302<=x)&&(x<=474.876)) {
            limit =1.08607+(x-450.302)*(0.98457-1.08607)/(474.876-450.302);
      }
      if ((474.876<=x)&&(x<=499.945)) {
            limit =0.98457+(x-474.876)*(0.964323-0.98457)/(499.945-474.876);
      }
      if ((499.945<=x)&&(x<=525.344)) {
            limit =0.964323+(x-499.945)*(1.04486-0.964323)/(525.344-499.945);
      }
      if ((525.344<=x)&&(x<=574.986)) {
            limit =1.04486+(x-525.344)*(1.12546-1.04486)/(574.986-525.344);
      }
      if ((574.986<=x)&&(x<=600.055)) {
            limit =1.12546+(x-574.986)*(0.965365-1.12546)/(600.055-574.986);
      }
      if ((600.055<=x)&&(x<=649.863)) {
            limit =0.965365+(x-600.055)*(0.866276-0.965365)/(649.863-600.055);
      }
      if ((649.863<=x)&&(x<=674.766)) {
            limit =0.866276+(x-649.863)*(0.956966-0.866276)/(674.766-649.863);
      }
      if ((674.766<=x)&&(x<=699.835)) {
            limit =0.956966+(x-674.766)*(1.09531-0.956966)/(699.835-674.766);
      }
      if ((699.835<=x)&&(x<=725.069)) {
            limit =1.09531+(x-699.835)*(1.30475-1.09531)/(725.069-699.835);
      }
      if ((725.069<=x)&&(x<=750)) {
            limit =1.30475+(x-725.069)*(1.42122-1.30475)/(750-725.069);
      }
}
if ((2.5<y) && (y<=5))
{
      if ((400<=x)&&(x<=424.501)) {
            limit =1.65343+(x-400)*(1.36643-1.65343)/(424.501-400);
      }
      if ((424.501<=x)&&(x<=450.427)) {
            limit =1.36643+(x-424.501)*(1.18592-1.36643)/(450.427-424.501);
      }
      if ((450.427<=x)&&(x<=474.359)) {
            limit =1.18592+(x-450.427)*(1.16606-1.18592)/(474.359-450.427);
      }
      if ((474.359<=x)&&(x<=500)) {
            limit =1.16606+(x-474.359)*(1.1083-1.16606)/(500-474.359);
      }
      if ((500<=x)&&(x<=549.858)) {
            limit =1.1083+(x-500)*(1.25271-1.1083)/(549.858-500);
      }
      if ((549.858<=x)&&(x<=600)) {
            limit =1.25271+(x-549.858)*(1.28339-1.25271)/(600-549.858);
      }
      if ((600<=x)&&(x<=625.641)) {
            limit =1.28339+(x-600)*(1.22383-1.28339)/(625.641-600);
      }
      if ((625.641<=x)&&(x<=649.858)) {
            limit =1.22383+(x-625.641)*(1.13718-1.22383)/(649.858-625.641);
      }
      if ((649.858<=x)&&(x<=674.359)) {
            limit =1.13718+(x-649.858)*(1.13538-1.13718)/(674.359-649.858);
      }
      if ((674.359<=x)&&(x<=700.855)) {
            limit =1.13538+(x-674.359)*(1.34838-1.13538)/(700.855-674.359);
      }
      if ((700.855<=x)&&(x<=724.217)) {
            limit =1.34838+(x-700.855)*(1.62274-1.34838)/(724.217-700.855);
      }
      if ((724.217<=x)&&(x<=750)) {
            limit =1.62274+(x-724.217)*(1.7509-1.62274)/(750-724.217);
      }
}
if ((5<y) && (y<=10))
{
      if ((400<=x)&&(x<=424.941)) {
            limit =2.13333+(x-400)*(1.65294-2.13333)/(424.941-400);
      }
      if ((424.941<=x)&&(x<=450.119)) {
            limit =1.65294+(x-424.941)*(1.32353-1.65294)/(450.119-424.941);
      }
      if ((450.119<=x)&&(x<=474.822)) {
            limit =1.32353+(x-450.119)*(1.1902-1.32353)/(474.822-450.119);
      }
      if ((474.822<=x)&&(x<=500.238)) {
            limit =1.1902+(x-474.822)*(1.13725-1.1902)/(500.238-474.822);
      }
      if ((500.238<=x)&&(x<=525.178)) {
            limit =1.13725+(x-500.238)*(1.2-1.13725)/(525.178-500.238);
      }
      if ((525.178<=x)&&(x<=549.644)) {
            limit =1.2+(x-525.178)*(1.3-1.2)/(549.644-525.178);
      }
      if ((549.644<=x)&&(x<=575.059)) {
            limit =1.3+(x-549.644)*(1.34118-1.3)/(575.059-549.644);
      }
      if ((575.059<=x)&&(x<=625.178)) {
            limit =1.34118+(x-575.059)*(1.23137-1.34118)/(625.178-575.059);
      }
      if ((625.178<=x)&&(x<=649.881)) {
            limit =1.23137+(x-625.178)*(1.11765-1.23137)/(649.881-625.178);
      }
      if ((649.881<=x)&&(x<=676.01)) {
            limit =1.11765+(x-649.881)*(1.11961-1.11765)/(676.01-649.881);
      }
      if ((676.01<=x)&&(x<=700.475)) {
            limit =1.11961+(x-676.01)*(1.04902-1.11961)/(700.475-676.01);
      }
      if ((700.475<=x)&&(x<=724.941)) {
            limit =1.04902+(x-700.475)*(1.05686-1.04902)/(724.941-700.475);
      }
      if ((724.941<=x)&&(x<=734.917)) {
            limit =1.05686+(x-724.941)*(0.992157-1.05686)/(734.917-724.941);
      }
      if ((734.917<=x)&&(x<=744.893)) {
            limit =0.992157+(x-734.917)*(0.978431-0.992157)/(744.893-734.917);
      }
      if ((744.893<=x)&&(x<=750)) {
            limit =0.978431+(x-744.893)*(1.00588-0.978431)/(750-744.893);
      }
}
if ((10<y) && (y<=25))
{
      if ((400<=x)&&(x<=424.092)) {
            limit =2.5772+(x-400)*(2.09007-2.5772)/(424.092-400);
      }
      if ((424.092<=x)&&(x<=449.47)) {
            limit =2.09007+(x-424.092)*(1.66944-2.09007)/(449.47-424.092);
      }
      if ((449.47<=x)&&(x<=474.652)) {
            limit =1.66944+(x-449.47)*(1.65974-1.66944)/(474.652-449.47);
      }
      if ((474.652<=x)&&(x<=499.884)) {
            limit =1.65974+(x-474.652)*(1.5479-1.65974)/(499.884-474.652);
      }
      if ((499.884<=x)&&(x<=549.952)) {
            limit =1.5479+(x-499.884)*(1.65439-1.5479)/(549.952-499.884);
      }
      if ((549.952<=x)&&(x<=574.449)) {
            limit =1.65439+(x-549.952)*(1.58769-1.65439)/(574.449-549.952);
      }
      if ((574.449<=x)&&(x<=625.369)) {
            limit =1.58769+(x-574.449)*(1.40201-1.58769)/(625.369-574.449);
      }
      if ((625.369<=x)&&(x<=650.065)) {
            limit =1.40201+(x-625.369)*(1.41607-1.40201)/(650.065-625.369);
      }
      if ((650.065<=x)&&(x<=674.035)) {
            limit =1.41607+(x-650.065)*(1.45864-1.41607)/(674.035-650.065);
      }
      if ((674.035<=x)&&(x<=699.467)) {
            limit =1.45864+(x-674.035)*(1.42518-1.45864)/(699.467-674.035);
      }
      if ((699.467<=x)&&(x<=735.635)) {
            limit =1.42518+(x-699.467)*(1.29188-1.42518)/(735.635-699.467);
      }
      if ((735.635<=x)&&(x<=739.437)) {
            limit =1.29188+(x-735.635)*(1.2871-1.29188)/(739.437-735.635);
      }
      if ((739.437<=x)&&(x<=744.445)) {
            limit =1.2871+(x-739.437)*(1.24668-1.2871)/(744.445-739.437);
      }
      if ((744.445<=x)&&(x<=750)) {
            limit =1.24668+(x-744.445)*(1.26565-1.24668)/(750-744.445);
      }
}


return limit;
}
